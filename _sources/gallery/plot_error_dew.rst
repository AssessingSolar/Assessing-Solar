
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/plot_error_dew.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_plot_error_dew.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_plot_error_dew.py:


Dew on radiometers
==================

Dew on radiometers cause a deviation of the measured irradiance compared to
the true value.

.. GENERATED FROM PYTHON SOURCE LINES 10-30

This issue is most often observed during the morning on cold days for
unventilated and unheated pyranometers.

The issue of dew on pyranometers is illustrated in the image below, which
shows a shaded pyranometer with dew and unshaded pyranometer without dew. The
photo was taken at the DTU Climate Station in Copenhagen (January 12th 2021).

The reason that dew remained on the unshaded pyranometer is that the direct
irradiance on the unshaded pyranometer had caused the dew to evaporate
although this process is not instantaneous and the unshaded pyranometer also
had been affected earlier in the day.

.. image:: ../graphics/dew_pyranometers_dtu_20210112.jpg
  :alt: Image of two pyranometers, one with dew and one without.
  :width: 400

Impact of dew
-------------
Let's take a look at some irradiance measuremens from DTU's Climate Station
and see if we can observe this phenomenon.

.. GENERATED FROM PYTHON SOURCE LINES 30-50

.. code-block:: default

    import numpy as np
    import pandas as pd
    import matplotlib.pyplot as plt
    import pvlib
    # sphinx_gallery_thumbnail_number = 2

    filename = '../notebooks/data/solar_irradiance_dtu_2019_extended.csv'
    df = pd.read_csv(filename, index_col=0, parse_dates=True)

    # Calculate Global Horizontal Irradiance (GHI) from Diffuse Horizontal
    # Irradiance (DHI) and Direct Normal Irradiance (DNI) using the closure
    # equation.
    df['ghi_calc'] = df['dhi'] + df['dni']*np.cos(np.deg2rad(df['zenith']))
    df['is_daytime'] = df['zenith'] < 90
    df['hourofday'] = df.index.hour

    # Compare the calculated and measured GHI:
    df.plot.scatter(x='ghi', y='ghi_calc', s=1, alpha=0.5, grid=True)
    plt.show()




.. image-sg:: /gallery/images/sphx_glr_plot_error_dew_001.png
   :alt: plot error dew
   :srcset: /gallery/images/sphx_glr_plot_error_dew_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 51-54

Zooming in at the low irradiance region, it is possible to detect swirling
lines, where measured GHI is initially higher than the calculated GHI and
then the reverse occurs.

.. GENERATED FROM PYTHON SOURCE LINES 54-58

.. code-block:: default

    df[df['is_daytime']].plot.scatter(x='ghi', y='ghi_calc', s=1, alpha=0.5,
                                      grid=True, xlim=(-10, 400), ylim=(-10, 400))
    plt.show()




.. image-sg:: /gallery/images/sphx_glr_plot_error_dew_002.png
   :alt: plot error dew
   :srcset: /gallery/images/sphx_glr_plot_error_dew_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 59-61

For a closer inspection of the data, let's find a specific day where this
phenomenon is pronounced. As an example we'll look at May 11th 2019.

.. GENERATED FROM PYTHON SOURCE LINES 61-66

.. code-block:: default

    df['2019-05-11 03':'2019-05-11 20'].plot.scatter(
        x='ghi', y='ghi_calc', s=1, grid=True, c='hourofday', cmap='plasma',
        sharex=False)
    plt.show()




.. image-sg:: /gallery/images/sphx_glr_plot_error_dew_003.png
   :alt: plot error dew
   :srcset: /gallery/images/sphx_glr_plot_error_dew_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 67-70

From the above plot, it's clear that this phenomenon occurs in the morning.
Let's see if we also can see the issue in the raw measurements for the same
day:

.. GENERATED FROM PYTHON SOURCE LINES 70-74

.. code-block:: default

    df.loc['2019-05-11 03':'2019-05-11 20',
           ['dni', 'ghi_calc', 'ghi', 'dhi']].plot(grid=True, alpha=0.5)
    plt.show()




.. image-sg:: /gallery/images/sphx_glr_plot_error_dew_004.png
   :alt: plot error dew
   :srcset: /gallery/images/sphx_glr_plot_error_dew_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 75-79

The wobbly nature of the GHI measurements is clearly not realistic but is
caused by dew. In the beginning of the morning the measured GHI is reduced
but then as the dew evaporates, more irradiance is focused onto the GHI
sensors and consequently the measured irradiance is overestimated.

.. GENERATED FROM PYTHON SOURCE LINES 81-84

Let's attempt to see if we can detect the dewy periods using a traditional
Kd vs. Kt plot. This type of plot is commonly used in quality assessment
of irradiance measurements.

.. GENERATED FROM PYTHON SOURCE LINES 84-94

.. code-block:: default

    df['Kd'] = df['dhi'] / df['ghi']
    df['dni_extra'] = pvlib.irradiance.get_extra_radiation(df.index)
    df['ghi_extra'] = df['dni_extra'] * np.cos(np.deg2rad(df['zenith']))
    df['Kt'] = df['ghi'] / df['ghi_extra']

    df['2019-05-11 03':'2019-05-11 20'].plot.scatter(
        x='Kt', y='Kd', grid=True, xlim=(0, 1.1), ylim=(0, 1.1), s=5,
        c='hourofday', cmap='plasma', sharex=False)
    plt.show()




.. image-sg:: /gallery/images/sphx_glr_plot_error_dew_005.png
   :alt: plot error dew
   :srcset: /gallery/images/sphx_glr_plot_error_dew_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 95-98

The irradiance measurements affected by dew are within the zone of valid
data, thus this type of plot does not seem to be useful for detecting periods
with dew.

.. GENERATED FROM PYTHON SOURCE LINES 100-108

Pyrheliometers
--------------
Pyrheliometers are much less affected by dew due to their smaller view of the
sky hemisphere. The rain shield, which is typically mounted on the front of
a pyrheliometer, also helps reduce the long-wave radiation exchange with the
sky. Additionally, when there is direct irradiance, the dew on a
pyrheliometer is typically evaporated faster than on a pyranometer.
In short, dew is less common on pyrheliometers although it can be observed.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 4.058 seconds)


.. _sphx_glr_download_gallery_plot_error_dew.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_error_dew.py <plot_error_dew.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_error_dew.ipynb <plot_error_dew.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
