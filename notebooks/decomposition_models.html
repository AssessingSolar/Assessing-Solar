
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solar Decomposition Models &#8212; Solar Resource Assessment in Python</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://assessingsolar.org/notebooks/decomposition_models.html" />
    <link rel="shortcut icon" href="../_static/assessing_solar_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ground-based solar irradiance data" href="ground_measurements.html" />
    <link rel="prev" title="Manipulating Time-series" href="manipulating_time_series.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/assessing_solar_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Solar Resource Assessment in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Solar fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="solar_position.html">
   Solar Position
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solar_components.html">
   Solar Components
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="manipulating_time_series.html">
   Manipulating Time-Series
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Solar radiation modeling
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Decomposition
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Solar resource data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ground_measurements.html">
   Ground Measurements
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="bsrn.html">
     Baseline Surface Radiation Network (BSRN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="srml.html">
     SRML
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quality_asessment.html">
   Quality Assessment
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="solar_power_modeling.html">
   Solar Power Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="site_adaptation.html">
   Site Adaptation
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://iea-pvps.org/research-tasks/solar-resource-for-high-penetration-and-large-scale-applications/">
   IEA PVPS Task 16
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/decomposition_models.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/AssessingSolar/AssessingSolar/issues/new?title=Issue%20on%20page%20%2Fnotebooks/decomposition_models.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AssessingSolar/AssessingSolar/main?urlpath=tree/AssessingSolar/notebooks/decomposition_models.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-role-of-solar-decomposition-models">
   The role of solar decomposition models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preparation">
   Data preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieving-weather-data">
     Retrieving weather data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#disc-model">
   DISC model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dirint-model">
   DIRINT model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dirindex-model">
   DIRINDEX model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#erbs-model">
   Erbs model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparison-and-evaluation-of-decomposition-models">
   Comparison and evaluation of decomposition models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-summary">
   Section summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="solar-decomposition-models">
<h1>Solar Decomposition Models<a class="headerlink" href="#solar-decomposition-models" title="Permalink to this headline">¶</a></h1>
<p>Knowing the direct or beam normal irradiance (DNI) is useful for many solar and energy applications, e.g., calculating the yield of solar concetrating power systems or determining the irradiance on an inclined surface. However, often only global horizontal irradiance (GHI) is available, as it is much cheaper to measure than the individual components and most satelitte radiation models only calculate GHI. Many applications, therefore, require applying <strong>solar radiation decomposition models</strong> to obtain the direct beam irradiance. The majority of decomposition models work by applying an empirical correlations between GHI, diffuse horizontal irradiance (DHI) and DNI. In this section, we present the implementation in Python of several solar decomposition models.</p>
<hr class="docutils" />
<div style="text-align: right"> <i>Content by Javier Lopez Lorente and Adam R. Jensen</i> </div>
<div class="section" id="the-role-of-solar-decomposition-models">
<h2>The role of solar decomposition models<a class="headerlink" href="#the-role-of-solar-decomposition-models" title="Permalink to this headline">¶</a></h2>
<p>Solar decomposition models are some of the most frequently used algorithms, and are often used during the first part of a larger analysis. As described earlier, decomposition models permit estimating the beam or direct normal irradiance (DNI) from GHI measurements, often using relationships between the clearness index (<span class="math notranslate nohighlight">\(k_t\)</span>) and the diffuse fraction of solar irradiance (<span class="math notranslate nohighlight">\(k_d\)</span>). The clearness index is defined as:</p>
<div class="math notranslate nohighlight">
\[ k_t = \frac{GHI}{E_a \cdot cos(\theta_Z)}\]</div>
<p>where <span class="math notranslate nohighlight">\(E_a\)</span> is the extraterrestrial irradiance, and <span class="math notranslate nohighlight">\(\theta_Z\)</span> is the solar zenith angle.</p>
<p>The diffuse fraction is defined as:</p>
<div class="math notranslate nohighlight">
\[ k_d = \frac{DHI}{GHI} \]</div>
<p>The role of decomposition models can be graphically illustrated in the diagram below:</p>
<a class="bg-white mb-1 reference internal image-reference" href="../_images/decomposition_models.png"><img alt="decomposition_flowchart" class="bg-white mb-1 align-center" src="../_images/decomposition_models.png" style="width: 500px;" /></a>
<p>Multiple models have been proposed for the decomposition of global horizontal radiation/irradiance into its direct normal and diffuse horizontal components in the scientific literature. Below, the implementation in Python of some of these methods will be shown. The following methods will be modelled and compared:</p>
<ul class="simple">
<li><p>DISC model (Maxwell, 1987)</p></li>
<li><p>DIRINT model (Pérez et al., 1992)</p></li>
<li><p>DIRINDEX model (Pérez et al., 2002)</p></li>
<li><p>Erbs model (Erbs et al., 1982)</p></li>
</ul>
<p>The four decomposition models, among some others, are implemented in the open-source library <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/api.html#dni-estimation-models">pvlib python</a>.</p>
<p>Before applying the models in practice, an example irradiance data set will be retrieved.</p>
</div>
<div class="section" id="data-preparation">
<h2>Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">¶</a></h2>
<p>To illustrate the implementation of each of these models, we will use real irradiance observations. The decomposition models will be used to calculate DNI and DIh from measured GHI, and the results will then be compared to measurements of DNI and DHI. The first step is getting and preparing the measurement data to be used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import all the necessary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pvlib</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="retrieving-weather-data">
<h3>Retrieving weather data<a class="headerlink" href="#retrieving-weather-data" title="Permalink to this headline">¶</a></h3>
<p>The irradiance data used is from the <a class="reference external" href="https://bsrn.awi.de/">BSRN</a> Cabauw station operated by the Royal Netherlands Meteorological Institute (KNMI). The data is retrieved from the BSRN FTP server using the <code class="docutils literal notranslate"><span class="pre">get_bsrn</span></code> function from pvlib-python. The Cabauw station is located at latitude 51.9711° and longitude 4.9267°, at an elevation of 0 m AMSL. The reason for choosing the Cabauw station is that the data has already been extensively quality checked, hence in this example this step is skipped. The data used are 1-minute global, direct, and diffuse irradiance measurements between January and July 2021, which are resampled to hourly observations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieving the measurement data</span>
<span class="n">df</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">iotools</span><span class="o">.</span><span class="n">get_bsrn</span><span class="p">(</span>
    <span class="n">station</span><span class="o">=</span><span class="s1">&#39;CAB&#39;</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">),</span>
    <span class="n">end</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2021-07-31&#39;</span><span class="p">),</span>
    <span class="n">username</span><span class="o">=</span><span class="n">bsrn_username</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">bsrn_password</span><span class="p">)</span>

<span class="c1"># Resample the 1-minute data to hourly</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Display the first five rows of the dataset</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>ghi_std</th>
      <th>ghi_min</th>
      <th>ghi_max</th>
      <th>dni</th>
      <th>dni_std</th>
      <th>dni_min</th>
      <th>dni_max</th>
      <th>dhi</th>
      <th>dhi_std</th>
      <th>dhi_min</th>
      <th>dhi_max</th>
      <th>lwd</th>
      <th>lwd_std</th>
      <th>lwd_min</th>
      <th>lwd_max</th>
      <th>temp_air</th>
      <th>relative_humidity</th>
      <th>pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-01-01 00:00:00+00:00</th>
      <td>-1.150000</td>
      <td>0.076667</td>
      <td>-1.366667</td>
      <td>-1.033333</td>
      <td>1.000000</td>
      <td>0.008333</td>
      <td>1.000000</td>
      <td>1.133333</td>
      <td>-1.000000</td>
      <td>0.050000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>242.133333</td>
      <td>0.288333</td>
      <td>241.666667</td>
      <td>242.633333</td>
      <td>-1.531667</td>
      <td>99.360000</td>
      <td>1006.000000</td>
    </tr>
    <tr>
      <th>2021-01-01 01:00:00+00:00</th>
      <td>-1.000000</td>
      <td>0.078333</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>1.150000</td>
      <td>0.005000</td>
      <td>1.050000</td>
      <td>1.550000</td>
      <td>-1.000000</td>
      <td>0.051667</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>243.666667</td>
      <td>0.253333</td>
      <td>243.216667</td>
      <td>244.100000</td>
      <td>-2.320000</td>
      <td>98.990000</td>
      <td>1006.000000</td>
    </tr>
    <tr>
      <th>2021-01-01 02:00:00+00:00</th>
      <td>-1.000000</td>
      <td>0.081667</td>
      <td>-1.016667</td>
      <td>-0.900000</td>
      <td>1.266667</td>
      <td>0.016667</td>
      <td>1.050000</td>
      <td>1.516667</td>
      <td>-0.600000</td>
      <td>0.051667</td>
      <td>-0.683333</td>
      <td>-0.500000</td>
      <td>265.950000</td>
      <td>0.603333</td>
      <td>264.983333</td>
      <td>267.066667</td>
      <td>-0.808333</td>
      <td>98.183333</td>
      <td>1006.066667</td>
    </tr>
    <tr>
      <th>2021-01-01 03:00:00+00:00</th>
      <td>-1.000000</td>
      <td>0.075000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>1.583333</td>
      <td>0.006667</td>
      <td>1.383333</td>
      <td>1.616667</td>
      <td>-0.533333</td>
      <td>0.065000</td>
      <td>-0.833333</td>
      <td>-0.333333</td>
      <td>271.800000</td>
      <td>0.578333</td>
      <td>270.800000</td>
      <td>272.733333</td>
      <td>-0.930000</td>
      <td>98.736667</td>
      <td>1006.216667</td>
    </tr>
    <tr>
      <th>2021-01-01 04:00:00+00:00</th>
      <td>-0.966667</td>
      <td>0.076667</td>
      <td>-1.000000</td>
      <td>-0.850000</td>
      <td>1.316667</td>
      <td>0.005000</td>
      <td>1.233333</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>0.061667</td>
      <td>-0.350000</td>
      <td>0.000000</td>
      <td>291.933333</td>
      <td>0.231667</td>
      <td>291.500000</td>
      <td>292.266667</td>
      <td>-0.171667</td>
      <td>97.960000</td>
      <td>1006.050000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Besides GHI, DNI and DHI, this station has additional weather-related variables available (e.g., air temperature, humidity, and wind speed), as well as sensor-specific data. The details of the sensors and measurements available in each station can be found under the section “Instrument history and meta data” of each MIDC’s station webpage.</p>
<p>Let’s list the variables available and then subset those that we will use in this example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize variables avilable</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;ghi&#39;, &#39;ghi_std&#39;, &#39;ghi_min&#39;, &#39;ghi_max&#39;, &#39;dni&#39;, &#39;dni_std&#39;, &#39;dni_min&#39;,
       &#39;dni_max&#39;, &#39;dhi&#39;, &#39;dhi_std&#39;, &#39;dhi_min&#39;, &#39;dhi_max&#39;, &#39;lwd&#39;, &#39;lwd_std&#39;,
       &#39;lwd_min&#39;, &#39;lwd_max&#39;, &#39;temp_air&#39;, &#39;relative_humidity&#39;, &#39;pressure&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>It is often helpful to visualize the data in order to check that the measurements are within the expected ones. For example, a plot for a single day (18th July 2021):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2021-07-18&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ghi&#39;</span><span class="p">,</span><span class="s1">&#39;dhi&#39;</span><span class="p">,</span><span class="s1">&#39;dni&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Solar irradiance components, 18th July 2021&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f777574cc90&gt;
</pre></div>
</div>
<img alt="../_images/decomposition_models_11_1.png" src="../_images/decomposition_models_11_1.png" />
</div>
</div>
<p>For an overall representation of the data, it’s useful to inspect the the key statistical metrics for the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;ghi&#39;</span><span class="p">,</span><span class="s1">&#39;dni&#39;</span><span class="p">,</span><span class="s1">&#39;dhi&#39;</span><span class="p">,</span> <span class="s1">&#39;temp_air&#39;</span><span class="p">,</span> <span class="s1">&#39;relative_humidity&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dni</th>
      <th>dhi</th>
      <th>temp_air</th>
      <th>relative_humidity</th>
      <th>pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5088.000000</td>
      <td>5021.000000</td>
      <td>5006.000000</td>
      <td>5088.000000</td>
      <td>5088.000000</td>
      <td>5088.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>150.154482</td>
      <td>129.608143</td>
      <td>78.730762</td>
      <td>9.613794</td>
      <td>81.598316</td>
      <td>1016.147409</td>
    </tr>
    <tr>
      <th>std</th>
      <td>223.501191</td>
      <td>244.733398</td>
      <td>109.759797</td>
      <td>7.098631</td>
      <td>14.189124</td>
      <td>10.043831</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.033333</td>
      <td>-0.316667</td>
      <td>-1.827586</td>
      <td>-8.151667</td>
      <td>32.516667</td>
      <td>981.450000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-1.000000</td>
      <td>1.000000</td>
      <td>-0.783333</td>
      <td>4.133750</td>
      <td>72.566667</td>
      <td>1009.945833</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>21.075000</td>
      <td>1.316667</td>
      <td>18.233333</td>
      <td>8.776667</td>
      <td>84.843333</td>
      <td>1016.675000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>234.120833</td>
      <td>117.466667</td>
      <td>125.820833</td>
      <td>15.312083</td>
      <td>93.289167</td>
      <td>1023.575000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>926.033333</td>
      <td>958.500000</td>
      <td>568.216667</td>
      <td>29.330000</td>
      <td>100.000000</td>
      <td>1042.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Estimating other input variables:</strong></p>
<p>The 3 solar decomposition models that we will implement in this section (i.e., DISC, DIRINT and Erbs models) have different inputs to be implemented. <strong>Solar position data</strong> is a common input for the 3 models. The DISC and DIRINT models accept as a possible input the <strong>dew (wet-bulb) temperature</strong> (<span class="math notranslate nohighlight">\(T_d\)</span>). This variable is not directly available from our weather observations; however, it can be easily estimated using a simple conversion that has relative humidity (<span class="math notranslate nohighlight">\(RH\)</span>) and the ambient temperature (<span class="math notranslate nohighlight">\(T_a\)</span>) as input. This simple approximation is given by the equation below (Lawrence, 2005):</p>
<div class="math notranslate nohighlight">
\[ T_{d} = T_a (^{\circ} C) - \frac{100-RH (\%)}{5} \]</div>
<p>In Python, this equation could be implemented as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp_dew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp_air&#39;</span><span class="p">]</span><span class="o">-</span><span class="p">((</span><span class="mi">100</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;relative_humidity&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br>
<p>The solar position for the entire period can be calculated using the <code class="docutils literal notranslate"><span class="pre">pvlib.solarposition.get_solarposition</span></code> function which supports a number of different solar position algorithms. The default algorithm is an implementation of the NREL SPA algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a pvlib location object for the site</span>
<span class="n">location</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">Location</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mf">51.9711</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mf">4.9267</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cabauw&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the solar position for each index in the datarame for the specific location</span>
<span class="c1"># The 30 minute shift is applied in order to calculate the solar position at the middle of the hour!</span>
<span class="n">solpos</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">get_solarposition</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
<span class="n">solpos</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">solpos</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Let&#39;s have a look to the output</span>
<span class="n">solpos</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>apparent_zenith</th>
      <th>zenith</th>
      <th>apparent_elevation</th>
      <th>elevation</th>
      <th>azimuth</th>
      <th>equation_of_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-01-01 00:00:00+00:00</th>
      <td>149.693651</td>
      <td>149.693651</td>
      <td>-59.693651</td>
      <td>-59.693651</td>
      <td>21.451575</td>
      <td>-3.441097</td>
    </tr>
    <tr>
      <th>2021-01-01 01:00:00+00:00</th>
      <td>144.585022</td>
      <td>144.585022</td>
      <td>-54.585022</td>
      <td>-54.585022</td>
      <td>45.257706</td>
      <td>-3.460697</td>
    </tr>
    <tr>
      <th>2021-01-01 02:00:00+00:00</th>
      <td>137.059810</td>
      <td>137.059810</td>
      <td>-47.059810</td>
      <td>-47.059810</td>
      <td>63.685127</td>
      <td>-3.480288</td>
    </tr>
    <tr>
      <th>2021-01-01 03:00:00+00:00</th>
      <td>128.334219</td>
      <td>128.334219</td>
      <td>-38.334219</td>
      <td>-38.334219</td>
      <td>78.296833</td>
      <td>-3.499870</td>
    </tr>
    <tr>
      <th>2021-01-01 04:00:00+00:00</th>
      <td>119.152361</td>
      <td>119.152361</td>
      <td>-29.152361</td>
      <td>-29.152361</td>
      <td>90.721936</td>
      <td>-3.519442</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="disc-model">
<h2>DISC model<a class="headerlink" href="#disc-model" title="Permalink to this headline">¶</a></h2>
<p>The DISC model (Maxwell, 1987) requires the following inputs: GHI, solar zenith angle, and the atmospheric pressure, which is used to estimate the absolute (pressure-corrected) airmass.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># DISC method estimated with absolute airmass as input</span>
<span class="n">disc</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">irradiance</span><span class="o">.</span><span class="n">disc</span><span class="p">(</span>
    <span class="n">ghi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ghi&#39;</span><span class="p">],</span>
    <span class="n">solar_zenith</span><span class="o">=</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;apparent_zenith&#39;</span><span class="p">],</span>
    <span class="n">datetime_or_doy</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">pressure</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># Site pressure in Pascal</span>
</pre></div>
</div>
</div>
</div>
<p>The functoin returns the DNI, the clearness index (<span class="math notranslate nohighlight">\(k_t\)</span>) and the airmass estimation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">disc</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;dni&#39;, &#39;kt&#39;, &#39;airmass&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dirint-model">
<h2>DIRINT model<a class="headerlink" href="#dirint-model" title="Permalink to this headline">¶</a></h2>
<p>An implementatin of the DIRINT model (Pérez et al., 1992)  is also available in pvlib-python. The model requires the following inputs: GHI, solar zenith angle, atmospheric pressure, and dew (wet-bulb) temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimation of the DIRINT model</span>
<span class="n">dirint</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">irradiance</span><span class="o">.</span><span class="n">dirint</span><span class="p">(</span>
    <span class="n">ghi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ghi&#39;</span><span class="p">],</span>
    <span class="n">solar_zenith</span><span class="o">=</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;apparent_zenith&#39;</span><span class="p">],</span>
    <span class="n">times</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">pressure</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="c1"># atmospheric pressure in Pascal </span>
    <span class="n">temp_dew</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp_dew&#39;</span><span class="p">])</span> <span class="c1"># Dew temperature in Degree Celsius</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dirindex-model">
<h2>DIRINDEX model<a class="headerlink" href="#dirindex-model" title="Permalink to this headline">¶</a></h2>
<p>The DIRINDEX model (Pérez et al., 2002) was found to be one of the two best decomposition models in an extensive study by Gueymard and Ruiz-Arias (2016). The model is an enhancement of the DIRINT model by considering clearsky data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve clear-sky irradiance from CAMS McClear</span>
<span class="n">clearsky</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">iotools</span><span class="o">.</span><span class="n">get_cams</span><span class="p">(</span>
    <span class="n">latitude</span><span class="o">=</span><span class="n">location</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="n">location</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">altitude</span><span class="o">=</span><span class="n">location</span><span class="o">.</span><span class="n">altitude</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">end</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">email</span><span class="o">=</span><span class="n">sodapro_username</span><span class="p">)</span>

<span class="c1"># Estimation of the DIRINDEX model</span>
<span class="n">dirindex</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">irradiance</span><span class="o">.</span><span class="n">dirindex</span><span class="p">(</span>
    <span class="n">ghi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ghi&#39;</span><span class="p">],</span>
    <span class="n">ghi_clearsky</span><span class="o">=</span><span class="n">clearsky</span><span class="p">[</span><span class="s1">&#39;ghi_clear&#39;</span><span class="p">],</span>
    <span class="n">dni_clearsky</span><span class="o">=</span><span class="n">clearsky</span><span class="p">[</span><span class="s1">&#39;dni_clear&#39;</span><span class="p">],</span>
    <span class="n">zenith</span><span class="o">=</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;zenith&#39;</span><span class="p">],</span>
    <span class="n">times</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">pressure</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="c1"># atmospheric pressure in Pascal </span>
    <span class="n">temp_dew</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp_dew&#39;</span><span class="p">])</span> <span class="c1"># Dew temperature in Degree Celsius</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="erbs-model">
<h2>Erbs model<a class="headerlink" href="#erbs-model" title="Permalink to this headline">¶</a></h2>
<p>The Erbs model (Erbs et al., 1982) is a simple and very popular model that only requires GHI and the solar zenith angle. This model is also available in pvlib and the implementation is equally straight-forward:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">erbs</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">irradiance</span><span class="o">.</span><span class="n">erbs</span><span class="p">(</span>
    <span class="n">ghi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ghi&#39;</span><span class="p">],</span>
    <span class="n">zenith</span><span class="o">=</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;apparent_zenith&#39;</span><span class="p">],</span>
    <span class="n">datetime_or_doy</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">erbs</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;dni&#39;, &#39;dhi&#39;, &#39;kt&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comparison-and-evaluation-of-decomposition-models">
<h2>Comparison and evaluation of decomposition models<a class="headerlink" href="#comparison-and-evaluation-of-decomposition-models" title="Permalink to this headline">¶</a></h2>
<p>Once the 4 models are estimated, we can evaluate the results of the models against the actual DNI measurements available. For example, below we visualize the results of the models a single day and a week in July:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of models for a single day</span>
<span class="n">date</span> <span class="o">=</span> <span class="s1">&#39;2021-07-18&#39;</span>

<span class="n">disc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DISC&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">dirint</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DIRINT&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">dirindex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DIRINDEX&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">erbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Erbs&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reference&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Direct Normal Irradiance [W/m$^2$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [HH:MM]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of decomposition models</span><span class="se">\n</span><span class="s1">(July 18th 2021)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f77796a1190&gt;
</pre></div>
</div>
<img alt="../_images/decomposition_models_29_1.png" src="../_images/decomposition_models_29_1.png" />
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of models for several days on an hourly basis</span>
<span class="n">disc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20210709&#39;</span><span class="p">:</span><span class="s1">&#39;20210718&#39;</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DISC&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># format of date YYYYMMDD</span>
<span class="n">dirint</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20210709&#39;</span><span class="p">:</span><span class="s1">&#39;20210718&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DIRINT&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">dirindex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20210709&#39;</span><span class="p">:</span><span class="s1">&#39;20210718&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DIRINDEX&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">erbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20210709&#39;</span><span class="p">:</span><span class="s1">&#39;20210718&#39;</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Erbs&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20210709&#39;</span><span class="p">:</span><span class="s1">&#39;20210718&#39;</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reference&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Direct Normal Irradiance [W/m$^2$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of decomposition on an hourly basis</span><span class="se">\n</span><span class="s1"> (9th-18th July 2021)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/decomposition_models_30_0.png" src="../_images/decomposition_models_30_0.png" />
</div>
</div>
<p>The correlation between the obtained models and the measured observations can be also presented in <strong>scatter plots</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create multiple plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">disc</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">dirint</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">dirindex</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">erbs</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Add characteristics to each subplot in a loop</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Modelled DNI [W/m$^2$]&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;DISC&#39;</span><span class="p">,</span> <span class="s1">&#39;DIRINT&#39;</span><span class="p">,</span> <span class="s1">&#39;DIRINDEX&#39;</span><span class="p">,</span> <span class="s1">&#39;ERBS&#39;</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1200</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1200</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Observed DNI [W/m$^2$]&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/decomposition_models_32_0.png" src="../_images/decomposition_models_32_0.png" />
</div>
</div>
<p>The evaluation cannot be only based on a visual inspection. For solar resource assessment, there are a number of common metrics to evaluate the error and performance, which we will use below. These metrics are the mean bias error (MBE) and the root mean square error (RMSE). The MBE is the average error representing a systematic error to under- or overestimate and the RMSE is a measure of the dispersion of the deviations.</p>
<div class="math notranslate nohighlight">
\[ MBE = \frac{1}{n} \sum_{i=1}^{n} M_i - O_i \]</div>
<div class="math notranslate nohighlight">
\[ RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}{(M_i - O_i)^2}}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the size of the sample or dataset, <span class="math notranslate nohighlight">\(M_i\)</span> is each of the predicted values and <span class="math notranslate nohighlight">\(O_i\)</span> are the observed or true values. In Python, each of these evaluation metrics can be defined as function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mean Bias Error</span>
<span class="k">def</span> <span class="nf">mbe</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">observed</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">observed</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Root Mean Square Error </span>
<span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">observed</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">observed</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>For the comparison of evaluation metrics, only measurement for periods where the solar elevation is greater than 5 degrees are used:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span>
<span class="n">erbs</span> <span class="o">=</span> <span class="n">erbs</span><span class="p">[</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span>
<span class="n">disc</span> <span class="o">=</span> <span class="n">disc</span><span class="p">[</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span>
<span class="n">dirint</span> <span class="o">=</span> <span class="n">dirint</span><span class="p">[</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span>
<span class="n">dirindex</span> <span class="o">=</span> <span class="n">dirindex</span><span class="p">[</span><span class="n">solpos</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>For the DISC method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbe_disc</span> <span class="o">=</span> <span class="n">mbe</span><span class="p">(</span><span class="n">disc</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>
<span class="n">rmse_disc</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">disc</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DISC Decomposition Method:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MBE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mbe_disc</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">rmse_disc</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DISC Decomposition Method:
MBE 41.68 W/m²
RMSE 90.00 W/m²
</pre></div>
</div>
</div>
</div>
<p>For the DIRINT method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbe_dirint</span> <span class="o">=</span> <span class="n">mbe</span><span class="p">(</span><span class="n">dirint</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>
<span class="n">rmse_dirint</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">dirint</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DIRINT Decomposition Method:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MBE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mbe_dirint</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">rmse_dirint</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DIRINT Decomposition Method:
MBE 18.26 W/m²
RMSE 76.04 W/m²
</pre></div>
</div>
</div>
</div>
<p>For the DIRINDEX method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbe_dirindex</span> <span class="o">=</span> <span class="n">mbe</span><span class="p">(</span><span class="n">dirindex</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>
<span class="n">rmse_dirindex</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">dirindex</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DIRINDEX Decomposition Method:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MBE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mbe_dirindex</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">rmse_dirindex</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DIRINDEX Decomposition Method:
MBE -3.45 W/m²
RMSE 68.51 W/m²
</pre></div>
</div>
</div>
</div>
<p>For the Erbs method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbe_erbs</span> <span class="o">=</span> <span class="n">mbe</span><span class="p">(</span><span class="n">erbs</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>
<span class="n">rmse_erbs</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">erbs</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dni&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Erbs Decomposition Method:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MBE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mbe_erbs</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">rmse_erbs</span> <span class="o">+</span> <span class="s2">&quot; W/m</span><span class="se">\u00b2</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Erbs Decomposition Method:
MBE 14.06 W/m²
RMSE 81.79 W/m²
</pre></div>
</div>
</div>
</div>
<p>The performance metrics show that, in this example, the DIRINDEX method reports the lowest error metrics, followed by the Erbs model, the DISC, and the DIRINT methods, respectively.</p>
</div>
<div class="section" id="section-summary">
<h2>Section summary<a class="headerlink" href="#section-summary" title="Permalink to this headline">¶</a></h2>
<p>This section has presented the solar radiation decomposition methods, which are a common type of technique to estimate the direct normal or beam irradiance from global horizontal irradiance observations. Particularly, the following examples have been covered: <br></p>
<ul class="simple">
<li><p>The Python implementation of three solar radiation decomposition methods have been presented using real data, namely the models used are the DISC, DIRINT, DIRINDEX and Erbs models. <br></p></li>
<li><p>Time-series visualization and scatter plots have been introduced to evaluate differences in the models. <br></p></li>
<li><p>Two common error metrics to evaluate the performance, i.e. MBE and RMSE, have been introduced. <br></p></li>
</ul>
<p>Within solar resource assessment, decomposition methods are used as means to estimate the direct irradiance or irradiation for further analysis in particular applications. For example, in solar concentrating power where direct irradiance is essential for power generation availability. There are multiple decomposition methods available in the literature. However, the Python functions for these 4 methods are available in the Python library <em>pvlib</em>.</p>
</div>
<hr class="docutils" />
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Andreas, A., and Wilcox, S., (2010). ‘Observed atmospheric and solar information system (OASIS)’, Tucson, Arizona (Data), NREL Report No. DA-5500-56494. <a class="reference external" href="http://dx.doi.org/10.5439/1052226">http://dx.doi.org/10.5439/1052226</a></p>
<p>Erbs, D. G., Klein, S. A., and Duffie, J. A., (1982). ‘Estimation of the diffuse radiation fraction for hourly, daily and monthly-average global radiation’, Solar Energy 28(4), pp 293-302.</p>
<p>Gueymard, C. A and Ruiz-Arias, J. A., (2016). ‘Extensive worldwide validation and climate sensitivity analysis of direct irradiance predictions from 1-min global irradiance’, Solar Energy 128, pp 1-30. <a class="reference external" href="https://doi.org/10.1016/j.solener.2015.10.010">https://doi.org/10.1016/j.solener.2015.10.010</a></p>
<p>Lawrence, M. G. (2005). ‘The relationship between relative humidity and the dewpoint temperature in moist air: A simple conversion and applications’, Bulletin of the American Meteorological Society, 86(2), pp. 225-234. <a class="reference external" href="https://doi.org/10.1175/BAMS-86-2-225">https://doi.org/10.1175/BAMS-86-2-225</a></p>
<p>Maxwell, E. L., (1987). ‘A quasi-physical model for converting hourly global horizontal to direct normal insolation’, Technical Report No. SERI/TR-215-3087, Golden, CO: Solar Energy Research Institute.</p>
<p>Perez, R., Ineichen, P., Maxwell, E.,  Seals, R., and Zelenka, A., (1992). ‘Dynamic global-to-direct irradiance conversion models’. ASHRAE Transactions-Research Series, pp. 354-369</p>
<p>Perez, R. et al. (2002) ‘A new operational model for satellite-derived irradiances: Description and validation’, Solar Energy, 73(5), pp. 307–317. <a class="reference external" href="https://doi.org/10.1016/S0038-092X(02)00122-6">https://doi.org/10.1016/S0038-092X(02)00122-6</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "AssessingSolar/AssessingSolar",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="manipulating_time_series.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Manipulating Time-series</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="ground_measurements.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Ground-based solar irradiance data</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The Assessing Solar Community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-207152593-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>